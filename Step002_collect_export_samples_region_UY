/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var N2_Bosque = /* color: #1f4423 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.09677206593099, -30.293423358499943],
                  [-57.09758745747152, -30.294312684123625],
                  [-57.09576355534139, -30.295813402826862],
                  [-57.09387528019491, -30.296535962900794],
                  [-57.0925234468514, -30.295109364813406],
                  [-57.09608542042318, -30.292552552679453]]]),
            {
              "reference": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.094948163800865, -30.29440532174565]),
            {
              "reference": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.14125811203033, -30.2863640503293],
                  [-57.14325367553741, -30.288013120549213],
                  [-57.140335432129206, -30.291014727773362],
                  [-57.13829695327789, -30.289328651070957]]]),
            {
              "reference": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.1408933316043, -30.288457808896634]),
            {
              "reference": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.06487185019841, -30.103100117179157]),
            {
              "reference": 2,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.06590181846013, -30.102320444868177],
                  [-57.06259733695378, -30.10796364844272],
                  [-57.06002241629948, -30.107295391157034],
                  [-57.06388479728093, -30.101763532308798]]]),
            {
              "reference": 2,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.07540872325535, -30.092966745337236],
                  [-57.07935693492527, -30.09593717372996],
                  [-57.075752046009256, -30.098016420500045],
                  [-57.072533395191385, -30.094377709952095]]]),
            {
              "reference": 2,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.07562329997654, -30.094897533944685]),
            {
              "reference": 2,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.63754607771528, -30.789467176418587],
                  [-57.6375675353874, -30.7912551898292],
                  [-57.63570071791303, -30.79184504262957],
                  [-57.63567926024091, -30.789504043010187]]]),
            {
              "reference": 2,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.636902347551704, -30.79075749871415]),
            {
              "reference": 2,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.627706344912205, -30.795099167022126]),
            {
              "reference": 2,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.629465874025975, -30.79484111560185],
                  [-57.628435905764256, -30.795910181261977],
                  [-57.625732239077244, -30.794951709152507],
                  [-57.62701969940439, -30.7938826328335]]]),
            {
              "reference": 2,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.20048835778302, -30.389921269917643],
                  [-57.19851425194806, -30.38862560015675],
                  [-57.200187950373355, -30.385960168333032],
                  [-57.20233371758527, -30.386367391789648]]]),
            {
              "reference": 2,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.200702934504214, -30.38766309149699]),
            {
              "reference": 2,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.29639806679322, -30.945552564196156],
                  [-57.29777135780885, -30.94671196561076],
                  [-57.29365148476197, -30.949453985994808],
                  [-57.29120531014039, -30.94781614435615],
                  [-57.29566850594117, -30.945221304065445]]]),
            {
              "reference": 2,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.29504623344972, -30.946638353240743]),
            {
              "reference": 2,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.04163521139841, -30.540911139680954],
                  [-57.04378097861032, -30.542611356101062],
                  [-57.04163521139841, -30.545383384253892],
                  [-57.0383736452363, -30.543424492561385]]]),
            {
              "reference": 2,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.041463550021454, -30.54294400365785]),
            {
              "reference": 2,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.09881716326457, -30.93468777112993],
                  [-57.09800177172404, -30.93531355270603],
                  [-57.09538393572551, -30.933104893565417],
                  [-57.09684305742961, -30.932405474200518]]]),
            {
              "reference": 2,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.09662848070842, -30.933399384398903]),
            {
              "reference": 2,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.31960749039701, -30.371792205521],
                  [-57.31986498246244, -30.3766054355765],
                  [-57.316238635874306, -30.376679483418645],
                  [-57.31647467026762, -30.371810718398258]]]),
            {
              "reference": 2,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.3179123342996, -30.373828601004526]),
            {
              "reference": 2,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.26066284105283, -30.27897272989471]),
            {
              "reference": 2,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.26162843629819, -30.278416815405986],
                  [-57.261499690265474, -30.281770785003506],
                  [-57.258452700824556, -30.28217844200266],
                  [-57.258495616168794, -30.279065382003335]]]),
            {
              "reference": 2,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.198354871258715, -30.277645492210276],
                  [-57.198354871258715, -30.281407148374026],
                  [-57.193376691327074, -30.281147728440434],
                  [-57.19440665958879, -30.277793737547018]]]),
            {
              "reference": 2,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.19747510670183, -30.279164996295755]),
            {
              "reference": 2,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.47992719048043, -30.953831329129436],
                  [-57.48001302116891, -30.95578189091827],
                  [-57.47280324333688, -30.957051574832068],
                  [-57.47198785179635, -30.95524825061299],
                  [-57.47591460579415, -30.95329767792773]]]),
            {
              "reference": 2,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.475592740712365, -30.955211447723418]),
            {
              "reference": 2,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.55313313390492, -30.858935042620793],
                  [-57.55216753865956, -30.860519146825418],
                  [-57.548026207940566, -30.85886136271855],
                  [-57.54495776082753, -30.85871400274421],
                  [-57.54497921849965, -30.85700092642489],
                  [-57.54909909154652, -30.857424593309187]]]),
            {
              "reference": 2,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.55111611272572, -30.858990302510318]),
            {
              "reference": 2,
              "system:index": "29"
            })]),
    N2_Plantaciones_forestales = /* color: #935132 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.57044639980761, -30.306906636216926],
                  [-57.570789722561514, -30.308055189004673],
                  [-57.569738296627676, -30.310704219116396],
                  [-57.56872978603808, -30.310759792407907],
                  [-57.5690945664641, -30.306776960056677]]]),
            {
              "reference": 9,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.5701030770537, -30.308518311321322]),
            {
              "reference": 9,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.7449880414409, -30.786537651911747],
                  [-57.7449880414409, -30.788086083761875],
                  [-57.73975236944383, -30.787459340540394],
                  [-57.741039829770976, -30.78631644532639]]]),
            {
              "reference": 9,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.74340017370408, -30.786943195996688]),
            {
              "reference": 9,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.74585064012202, -30.77678564510341],
                  [-57.745764809433545, -30.77803926657449],
                  [-57.74434860307368, -30.778721377276824],
                  [-57.74441297609004, -30.776711902155178]]]),
            {
              "reference": 9,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.74512107926997, -30.777670556072916]),
            {
              "reference": 9,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.744305687729444, -30.774186172056847]),
            {
              "reference": 9,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.74470909170335, -30.773909628237682],
                  [-57.74569614462083, -30.775052670876327],
                  [-57.74571760229295, -30.775697930885116],
                  [-57.74327142767137, -30.774960490521785],
                  [-57.74361475042527, -30.774186172056847]]]),
            {
              "reference": 9,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.75101764730638, -30.78305358908976],
                  [-57.75024517111009, -30.783956876755813],
                  [-57.74814231924241, -30.78316419619856],
                  [-57.74839981130784, -30.782482117001333]]]),
            {
              "reference": 9,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.74912937215989, -30.783182630704317]),
            {
              "reference": 9,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.17591184161136, -30.378037169371122],
                  [-57.17593329928348, -30.383812648000998],
                  [-57.174946246366, -30.383812648000998],
                  [-57.17492478869388, -30.377963122557475]]]),
            {
              "reference": 9,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.17531102679202, -30.37922191076045]),
            {
              "reference": 9,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.176973706054035, -30.384769787905782],
                  [-57.17690933303768, -30.388342233888284],
                  [-57.17635143356258, -30.388342233888284],
                  [-57.17632997589046, -30.384714256626445]]]),
            {
              "reference": 9,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.17654455261165, -30.386602302419828]),
            {
              "reference": 9,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.09405508864036, -30.406564920069798],
                  [-57.09397998678794, -30.407573507733357],
                  [-57.09278908598533, -30.40789736394743],
                  [-57.09274617064109, -30.40711085413535]]]),
            {
              "reference": 9,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.09349718916526, -30.407221891198823]),
            {
              "reference": 9,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.124494466850656, -30.329308510786785],
                  [-57.124494466850656, -30.3304753216946],
                  [-57.1239794827198, -30.330493842390577],
                  [-57.123743448326486, -30.329197385213376]]]),
            {
              "reference": 9,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.12419405944099, -30.329734490983373]),
            {
              "reference": 9,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.28343173400062, -30.61373855696538],
                  [-57.284579719458996, -30.614735764460097],
                  [-57.28420421019691, -30.615160497866892],
                  [-57.2830669535746, -30.614227928593348],
                  [-57.28307768241066, -30.613590821648277]]]),
            {
              "reference": 9,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.28393598929542, -30.61450493030539]),
            {
              "reference": 9,
              "system:index": "19"
            })]),
    N2_Area_humeda_natural = /* color: #45c2a5 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.86078919215352, -30.57772538609736],
                  [-57.85696972651631, -30.57859364917546],
                  [-57.85630453868062, -30.573402428680783],
                  [-57.86003817362935, -30.57229394702096]]]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.85905112071187, -30.57440005134246]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.01524389256905, -30.124254207013827],
                  [-57.014857670402385, -30.12560904042017],
                  [-57.01369895517046, -30.126323574844825],
                  [-57.01331270207833, -30.12692675014159],
                  [-57.01196083811092, -30.126643728006975],
                  [-57.01146729765809, -30.125172915465583],
                  [-57.007733707327354, -30.123901574393727],
                  [-57.00927865971993, -30.122082712459843],
                  [-57.01174629201363, -30.12323342492322],
                  [-57.011928679316796, -30.12421708579403],
                  [-57.01254022588204, -30.12468107639538]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.01155317296456, -30.124514040770205]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.01897712949787, -30.132066858854046],
                  [-57.01829048399006, -30.134460825992477],
                  [-57.016659700909, -30.13477630570406],
                  [-57.01522203687702, -30.13420101841404],
                  [-57.01528640989338, -30.13290197026401],
                  [-57.016874277630194, -30.13189983572424],
                  [-57.017839872875555, -30.129932653152878],
                  [-57.01756092313801, -30.1292088685686],
                  [-57.01947065595661, -30.129264544494244],
                  [-57.01893421415363, -30.130637874053978]]]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.03694961271346, -30.128273564389833],
                  [-57.036099352455736, -30.129275735741814],
                  [-57.03326693973601, -30.130055195315606],
                  [-57.03275195560515, -30.127160028734185],
                  [-57.03472606144011, -30.126751729180377],
                  [-57.03652850589812, -30.12567529499054]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.03536174497664, -30.127939505011845]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.01712272367537, -30.13283892926841]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.00830738739469, -30.132733740753743],
                  [-57.00916569427945, -30.13533182438533],
                  [-57.007620741886875, -30.13599989197992],
                  [-57.00590412811734, -30.133401825933394]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.008135726017734, -30.133995675630338]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.87401677318992, -30.576464576732786],
                  [-57.87384511181297, -30.579568159976116],
                  [-57.87157059856834, -30.579531213140797],
                  [-57.87234307476463, -30.576760160369005],
                  [-57.87302972027244, -30.575799510257095]]]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.872943889583965, -30.57783164349756]),
            {
              "reference": 11,
              "system:index": "11"
            })]),
    N2_Pastizal = /* color: #b8af4f */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.582390082836525, -30.742650069262563],
                  [-57.58402086591758, -30.74390413533928],
                  [-57.579428924084084, -30.746799490243028],
                  [-57.57631756162681, -30.745158185090048],
                  [-57.58099533414878, -30.742318107862474]]]),
            {
              "reference": 12,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.58136011457481, -30.744106997435267]),
            {
              "reference": 12,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.60443114728027, -30.776287820051863],
                  [-57.60383033246094, -30.77827886858977],
                  [-57.5991954752832, -30.776914636073027],
                  [-57.60082625836426, -30.774112368060667]]]),
            {
              "reference": 12,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.6017703959375, -30.776656535853036]),
            {
              "reference": 12,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.24085715280942, -30.89621760538019],
                  [-57.24261668192319, -30.89912678402686],
                  [-57.23961260782651, -30.901188933071555],
                  [-57.23755267130307, -30.89750649290189]]]),
            {
              "reference": 12,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.23965552317075, -30.898832187680107]),
            {
              "reference": 12,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.334883239412314, -30.84376816253294],
                  [-57.33295204892159, -30.847673733877524],
                  [-57.33042004361153, -30.847084223862637],
                  [-57.33269455685616, -30.842110088888653],
                  [-57.33518364682198, -30.84288386015492]]]),
            {
              "reference": 12,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.33325245633126, -30.845131446064666]),
            {
              "reference": 12,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.308427361620005, -30.51154759991384],
                  [-57.306195763719614, -30.513174386045808],
                  [-57.30387833513075, -30.509920786561477],
                  [-57.30675366319471, -30.50851578948853]]]),
            {
              "reference": 12,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.30559494890028, -30.51058630440473]),
            {
              "reference": 12,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.58963876185826, -30.634219795977124],
                  [-57.5856476348441, -30.63842926685795],
                  [-57.58393102107457, -30.637616927091443],
                  [-57.588050894121444, -30.633665904594043]]]),
            {
              "reference": 12,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.58684926448277, -30.63588145110026]),
            {
              "reference": 12,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.05628073595093, -30.63491200032692],
                  [-57.05915606401489, -30.637275217691073],
                  [-57.056323651295166, -30.63915836519716],
                  [-57.05173170946167, -30.63631516759924],
                  [-57.055336598377686, -30.634321186965934]]]),
            {
              "reference": 12,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.05464995286987, -30.636056690946667]),
            {
              "reference": 12,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.049137277846604, -30.720602938971265],
                  [-57.050875349288255, -30.722226216215144],
                  [-57.04694859529045, -30.725306678564877],
                  [-57.04501740479973, -30.72390480371202]]]),
            {
              "reference": 12,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.04808585191277, -30.72174661441946]),
            {
              "reference": 12,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.61581151794849, -30.82587761302273],
                  [-57.617828539127686, -30.827370132983088],
                  [-57.614073446506836, -30.831276371690063],
                  [-57.611112287754395, -30.829673358997102]]]),
            {
              "reference": 12,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.61465280365405, -30.82864152057506]),
            {
              "reference": 12,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.20703557311021, -30.530201586850815],
                  [-57.20701411543809, -30.531292066687456],
                  [-57.204932721242535, -30.532364051883988],
                  [-57.20353797255479, -30.53110724045801],
                  [-57.206434758290875, -30.529647100883672]]]),
            {
              "reference": 12,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.206220181569684, -30.53088544851851]),
            {
              "reference": 12,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.16520446322391, -30.37489013032387],
                  [-57.16747897646854, -30.377148603905173],
                  [-57.16468947909305, -30.378259309475467],
                  [-57.16189998171756, -30.376408126513258]]]),
            {
              "reference": 12,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.16524737856815, -30.37651919847965]),
            {
              "reference": 12,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.27477029006826, -30.757223628417407],
                  [-57.277152091673486, -30.759565413597706],
                  [-57.27374032180654, -30.76187026464619],
                  [-57.27062895934927, -30.758864727941038],
                  [-57.27401927154409, -30.756836398608105]]]),
            {
              "reference": 12,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.27331116836416, -30.75962073066919]),
            {
              "reference": 12,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.424535928982785, -30.726486303742153],
                  [-57.42438572527795, -30.72844149227562],
                  [-57.41994398714929, -30.727777470428553],
                  [-57.4176051008883, -30.725951386762553],
                  [-57.41814154269128, -30.724899989565664],
                  [-57.42359179140954, -30.725656258882495]]]),
            {
              "reference": 12,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.42069500567346, -30.726486303742153]),
            {
              "reference": 12,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.29909412330025, -30.558345364803596],
                  [-57.299222869332965, -30.562040785704937],
                  [-57.296476287301715, -30.562114692687466],
                  [-57.296991271432574, -30.558604048847503]]]),
            {
              "reference": 12,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.29784957831734, -30.560156138629846]),
            {
              "reference": 12,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.07377163041396, -30.36740370834672],
                  [-57.07355705369277, -30.368144253940326],
                  [-57.066347275860736, -30.370439909638865],
                  [-57.06948009599013, -30.36632990727426],
                  [-57.07372871506972, -30.36673721251738]]]),
            {
              "reference": 12,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.07089630234999, -30.367514790543304]),
            {
              "reference": 12,
              "system:index": "29"
            })]),
    N2_Pastura = /* color: #ffd966 */ee.FeatureCollection([]),
    N2_Agricultura = /* color: #e974ed */ee.FeatureCollection([]),
    N2_Agricultura_Pastura = /* color: #ffefc3 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.64484794371062, -30.48565747130331],
                  [-57.64645726911956, -30.487931872365323],
                  [-57.64542730085784, -30.488837919771612],
                  [-57.64287383787566, -30.486711468647975],
                  [-57.64366777174407, -30.48452949658847]]]),
            {
              "reference": 21,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.64416129820281, -30.48654504877348]),
            {
              "reference": 21,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.16125093629088, -30.72047772433338],
                  [-57.16266714265074, -30.723908714434646],
                  [-57.16159425904478, -30.72545815381275],
                  [-57.15884767701353, -30.721805864017853]]]),
            {
              "reference": 21,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.160564290783064, -30.7226543881269]),
            {
              "reference": 21,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.15374075104918, -30.726380427333194],
                  [-57.15515695740904, -30.728630737690967],
                  [-57.153268682262556, -30.72958987039992],
                  [-57.15099416901793, -30.727376472824357]]]),
            {
              "reference": 21,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.152539121410506, -30.72767159543776]),
            {
              "reference": 21,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.57862486409553, -30.655447807484162],
                  [-57.57969774770149, -30.656333832591628],
                  [-57.57838882970222, -30.65766285502558],
                  [-57.577015538686595, -30.656555337599578]]]),
            {
              "reference": 21,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.57866777943977, -30.656592255051553]),
            {
              "reference": 21,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.87101319605042, -30.948592403200916],
                  [-57.87195733362366, -30.94995419501766],
                  [-57.868395360051885, -30.953303384211683],
                  [-57.8670649843805, -30.95183122759903]]]),
            {
              "reference": 21,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.869897397100225, -30.950984727274662]),
            {
              "reference": 21,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.865133793889775, -30.95260411264924],
                  [-57.86697915369202, -30.954885927268744],
                  [-57.86521962457825, -30.95624762937956],
                  [-57.86444714838196, -30.952567308741017]]]),
            {
              "reference": 21,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.86599210077454, -30.954959533284516]),
            {
              "reference": 21,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.64885618849107, -30.869383819593956],
                  [-57.64868452711411, -30.87056256185155],
                  [-57.64671042127915, -30.872220143624958],
                  [-57.645637537673196, -30.871593949435447],
                  [-57.646624590590676, -30.869236475792487]]]),
            {
              "reference": 21,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.64701082868882, -30.870673068194986]),
            {
              "reference": 21,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.03068874607718, -30.822245794801216],
                  [-57.03073166142142, -30.824972953926164],
                  [-57.02852152119315, -30.8244754374295],
                  [-57.028349859816196, -30.822466918696716]]]),
            {
              "reference": 21,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.02931545506156, -30.823554103776868]),
            {
              "reference": 21,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.20014181962255, -30.58564959770911],
                  [-57.19812479844335, -30.588383452951607],
                  [-57.1933611952329, -30.586092930824222],
                  [-57.19589320054296, -30.58317428388701]]]),
            {
              "reference": 21,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.196794422771966, -30.58624070807868]),
            {
              "reference": 21,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.8031388723053, -30.585284999590613],
                  [-57.80274190537109, -30.586633469925253],
                  [-57.79835381142273, -30.58661499785561],
                  [-57.79863276116028, -30.583991928227313],
                  [-57.803160329977416, -30.58397345565432]]]),
            {
              "reference": 21,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.802473684469604, -30.585155693230437]),
            {
              "reference": 21,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.096424165202706, -30.563927659600147],
                  [-57.096188130809395, -30.567050119828156],
                  [-57.093699040843575, -30.56701316822374],
                  [-57.093720498515694, -30.56355813102943]]]),
            {
              "reference": 21,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.095179620219795, -30.565645948965408]),
            {
              "reference": 21,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.131134857631736, -30.647402643548112],
                  [-57.129911770320945, -30.6495624952416],
                  [-57.12572752425771, -30.647439564495166],
                  [-57.12684332320791, -30.6460734800655]]]),
            {
              "reference": 21,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.12909637878042, -30.647956456273835]),
            {
              "reference": 21,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.3912917488749, -30.896808655449217],
                  [-57.39245046316933, -30.898244834431452],
                  [-57.38685001074624, -30.899404809420606],
                  [-57.38633502661538, -30.896642941103448],
                  [-57.38948930441689, -30.896348337113935]]]),
            {
              "reference": 21,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.38751519858193, -30.89721373375362]),
            {
              "reference": 21,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.344115019996735, -30.87962525504024],
                  [-57.34578871842203, -30.87918327019339],
                  [-57.34681868668375, -30.880177733231605],
                  [-57.342140914161774, -30.882277121303957],
                  [-57.34282755966959, -30.880398723616125]]]),
            {
              "reference": 21,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.34424376602945, -30.880582881880525]),
            {
              "reference": 21,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.38129354136745, -30.453968825872284],
                  [-57.379405266220964, -30.45226705945959],
                  [-57.37749821014113, -30.451688996646116],
                  [-57.37833774918196, -30.44983458644111],
                  [-57.37920142374241, -30.450602257186702],
                  [-57.3804566921548, -30.451009213011222],
                  [-57.38174415248195, -30.451786120087494]]]),
            {
              "reference": 21,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.38054252284328, -30.45226705945959]),
            {
              "reference": 21,
              "system:index": "29"
            })]),
    N2_Area_no_vegetada = /* color: #ea9999 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.606157227126886, -30.25852722328026],
                  [-57.60435478266888, -30.263346020460915],
                  [-57.593454285232355, -30.260084091302392],
                  [-57.595170899001886, -30.25526513406456]]]),
            {
              "reference": 22,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.59826080378704, -30.25971341067856]),
            {
              "reference": 22,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.78133950930589, -30.790189352351927],
                  [-57.77876458865159, -30.79076077864143],
                  [-57.77782045107835, -30.788327585078395],
                  [-57.78030954104417, -30.788161683275142]]]),
            {
              "reference": 22,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.77968726855271, -30.789415156477865]),
            {
              "reference": 22,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.32134837404355, -30.71382603054007],
                  [-57.32291478410825, -30.715025129046587],
                  [-57.32132691637143, -30.716261107287572],
                  [-57.320017998372165, -30.714508596133197]]]),
            {
              "reference": 22,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.321498577748386, -30.714859100911852]),
            {
              "reference": 22,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.43584760785329, -30.42856990333697],
                  [-57.438722935917255, -30.429495004892107],
                  [-57.43640550732839, -30.43293630565079],
                  [-57.43430265546071, -30.432159248350512]]]),
            {
              "reference": 22,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.43627676129567, -30.430864139092357]),
            {
              "reference": 22,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.44039663434255, -30.426849191108946],
                  [-57.43953832745778, -30.428125851474174],
                  [-57.436233845951435, -30.426127593077197],
                  [-57.43816503644216, -30.423759233825994],
                  [-57.4400103962444, -30.424628872418168]]]),
            {
              "reference": 22,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.43803629040944, -30.425998074916777]),
            {
              "reference": 22,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.59139428559794, -30.253718043698935],
                  [-57.59070764009013, -30.25631293707761],
                  [-57.58804688874736, -30.255312057752665],
                  [-57.58877644959941, -30.253087844961623]]]),
            {
              "reference": 22,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.58924851838603, -30.254385308543537]),
            {
              "reference": 22,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.58037478240771, -30.303065021097336],
                  [-57.57934481414599, -30.302851973251894],
                  [-57.579527204359, -30.301860831536185],
                  [-57.58011729034228, -30.300962311228403],
                  [-57.58084685119433, -30.30144399324208]]]),
            {
              "reference": 22,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.580213849866816, -30.302203563917022]),
            {
              "reference": 22,
              "system:index": "13"
            })]),
    N2_Cuerpos_de_agua = /* color: #0000ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.842574182512635, -30.654286703343654],
                  [-57.83914095497357, -30.66358967366056],
                  [-57.83313280678021, -30.664327966284812],
                  [-57.838110986711854, -30.65266228337763]]]),
            {
              "reference": 33,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.8379393253349, -30.65945513073063]),
            {
              "reference": 33,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.81167513466107, -30.697545295175168]),
            {
              "reference": 33,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.81390673256146, -30.69193605935557],
                  [-57.812361780168885, -30.702416209166554],
                  [-57.80669695472943, -30.702859007337263],
                  [-57.80841356849896, -30.690312272358312]]]),
            {
              "reference": 33,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.81476090345248, -30.45195759247387],
                  [-57.825918892954434, -30.45743275231096],
                  [-57.82403061780795, -30.460540138605644],
                  [-57.8132159510599, -30.455657058503558]]]),
            {
              "reference": 33,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.81802246961459, -30.45506515337672]),
            {
              "reference": 33,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.7552494794127, -30.938694022133223],
                  [-57.757824400066994, -30.942963800781122],
                  [-57.745293119549416, -30.95106113288859],
                  [-57.73962829410996, -30.946350041317125]]]),
            {
              "reference": 33,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.74889800846543, -30.944877777566507]),
            {
              "reference": 33,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.80834010503675, -30.899957045925806],
                  [-57.81529239080335, -30.90923628631945],
                  [-57.80902675054456, -30.912034610822158],
                  [-57.802675279597295, -30.90253470293562]]]),
            {
              "reference": 33,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.81125834844495, -30.904891357176293]),
            {
              "reference": 33,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.80215692104515, -30.797464198047116]),
            {
              "reference": 33,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.804437918067414, -30.791935838646964],
                  [-57.80752782285257, -30.80107808564947],
                  [-57.80126218259378, -30.801741601990358],
                  [-57.798429769874055, -30.79289434082432]]]),
            {
              "reference": 33,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.662339924596886, -30.950272784398884],
                  [-57.66122412564669, -30.953290730269263],
                  [-57.65624594571505, -30.952260222885855],
                  [-57.6575334060422, -30.94983112578735]]]),
            {
              "reference": 33,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.65890669705782, -30.951450530715142]),
            {
              "reference": 33,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.6160985127432, -30.947961007346063]),
            {
              "reference": 33,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.61807261857816, -30.947004054621363],
                  [-57.615240205858434, -30.950095713503977],
                  [-57.612493623827184, -30.947813784473748],
                  [-57.61541186723539, -30.94486927939331]]]),
            {
              "reference": 33,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.90681934193643, -30.94296117436686],
                  [-57.90606832341226, -30.954186837685267],
                  [-57.89969539479288, -30.95363478671921],
                  [-57.901755331316316, -30.943329249812667]]]),
            {
              "reference": 33,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.90415859059366, -30.948482157202783]),
            {
              "reference": 33,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.62289729176177, -30.268400902924867],
                  [-57.624442244154345, -30.271810810167626],
                  [-57.621953154188525, -30.272996837096155],
                  [-57.62083735523833, -30.268326773191124]]]),
            {
              "reference": 33,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.621953154188525, -30.27010587135188]),
            {
              "reference": 33,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.624957228285204, -30.285078669720036]),
            {
              "reference": 33,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.62633051930083, -30.283818670767463],
                  [-57.62512888966216, -30.287598619079287],
                  [-57.62238230763091, -30.28596807100271],
                  [-57.623412275892626, -30.282706893547907]]]),
            {
              "reference": 33,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.57819257711979, -30.202052713439446],
                  [-57.57879339193913, -30.202757418584092],
                  [-57.577634677644696, -30.203536297347988],
                  [-57.57656179403874, -30.20264614968614]]]),
            {
              "reference": 33,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.57780633902165, -30.20268323933276]),
            {
              "reference": 33,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.56587587332341, -30.207319335102007]),
            {
              "reference": 33,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.56647668814274, -30.206503398081576],
                  [-57.56660543417546, -30.207764388807384],
                  [-57.56548963522526, -30.208357790617075],
                  [-57.565189227815594, -30.207096807494587]]]),
            {
              "reference": 33,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.45654357738591, -30.30779966773132],
                  [-57.45667232341862, -30.30902230909752],
                  [-57.45568527050114, -30.309096408084095],
                  [-57.45465530223942, -30.308096067038726]]]),
            {
              "reference": 33,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.45598567791081, -30.308281316150715]),
            {
              "reference": 33,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.16018666413811, -30.495252881651986],
                  [-57.161817447219164, -30.496528645907386],
                  [-57.16046561387566, -30.49793381615984],
                  [-57.159049407515795, -30.496510156689826]]]),
            {
              "reference": 33,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.16033686784294, -30.49632526432096]),
            {
              "reference": 33,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.77118481095571, -30.7427099986498],
                  [-57.76843822892446, -30.73990673483788],
                  [-57.771528133709616, -30.73979607801396],
                  [-57.77367390092153, -30.74171411163736]]]),
            {
              "reference": 33,
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Point([-57.77118481095571, -30.741013296086823]),
            {
              "reference": 33,
              "system:index": "31"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

/*********************************************************************
Nombre del Intérprete 1: 
Data Inicio: 02/09/2020
Data Termino:
Debe terminar con muestras (# pixeles) entre 10.000 y 15.000
Orientaciones Generales
------------------------------------------------
¡Siempre "SAVE" después de la toma de muestras!
------------------------------------------------
*********************************************************************/

//var cartasBR = [
//"SH-21-Y-B","SH-21-Z-A"
//"SH-21-X-A", "SH-21-X-B", "SH-22-V-A", "SH-21-V-D",
//"SH-21-X-C", "SH-21-X-D", "SH-22-V-C", "SH-22-V-D",
//"SH-22-X-C", "SH-21-Y-B", "SH-21-Z-A", "SH-21-Z-B",
//"SH-22-Y-A", "SH-22-Y-B", "SH-22-Z-A", "SH-21-Z-C",
//"SH-21-Z-D", "SH-22-Y-C", "SH-22-Y-D", "SH-22-Z-C",
//"SI-22-V-A","SI-22-V-B", "SI-22-V-C"
//]
//var cartasAR = [
//"SH-21-Y-D"  
//"SH-20-Z-C","SH-20-Z-D","SH-21-Y-A","SH-21-Y-B",
//"SH-21-Y-C","SH-21-Y-D","SI-19-Z-B","SI-19-Z-D","SI-20-V-B","SI-20-V-C","SI-20-V-D","SI-20-X-A",
//"SI-20-X-B","SI-20-X-C","SI-20-X-D","SI-20-Y-A","SI-20-Y-B","SI-20-Y-C","SI-20-Y-D","SI-20-Z-A",
//"SI-20-Z-B","SI-20-Z-C","SI-20-Z-D","SI-21-V-A","SI-21-V-B","SI-21-V-C","SI-21-V-D","SI-21-Y-A",
//"SI-21-Y-B","SI-21-Y-C","SI-21-Y-D","SJ-19-X-B","SJ-19-X-D","SJ-20-V-A","SJ-20-V-B","SJ-20-V-C",
//"SJ-20-V-D","SJ-20-X-A","SJ-20-X-B","SJ-20-X-C","SJ-20-X-D","SJ-20-Y-B","SJ-20-Z-A","SJ-20-Z-B",
//"SJ-20-Z-C","SJ-20-Z-D","SJ-21-V-A","SJ-21-V-B","SJ-21-V-C","SJ-21-V-D","SJ-21-X-A","SJ-21-X-C",
//"SJ-21-Y-A","SJ-21-Y-B"
//]

//var cartasUY = [
//"SH-21-Z-A"  
//"SH-21-Y-B","SH-21-Y-D","SH-21-Z-A","SH-21-Z-C",
//"SH-21-Z-D","SI-21-V-B","SI-21-V-D","SI-21-X-A",
//"SI-21-X-B","SI-21-X-C","SI-21-X-D","SI-21-Y-B",
//"SI-21-Z-A","SI-21-Z-B","SI-22-V-A","SI-22-V-C",
//"SI-22-Y-A"
//] 

// Change to your grid_name
var grid_name = "SH-21-Y-B"; // todo trocar para regiao
 
//var biome = 'PampaBrasil'
//var biome = 'PampaArgentina'
var biome = 'PampaUruguay'

var version_out = 1     // Version that will be saved
var trainPoints = 2000   // Number of points to training
var validPoints = 500   // Number of points to validate

Map.setOptions("HYBRID");

//************************************
//Do not change bellow this point

var utils = require("users/schirmbeckj/PampaTriNacional:Utils/utils_Pampa.js")
var ts_tools = require("users/schirmbeckj/PampaTriNacional:Utils/time_series.js")

// ajustar para uso dos mapas de reagioes para cada país
var grids = ee.FeatureCollection("projects/MapBiomas_Pampa/ANCILLARY_DATA/CartasPampaTrinacional")
var myGrid = grids.filterMetadata('COD_INT', "equals", grid_name);
print(myGrid)
var dirasset = 'projects/MapBiomas_Pampa/MOSAICS/mosaics_c1';
var outputAsset = 'projects/MapBiomas_Pampa/SAMPLES/C1/'

// Landsat images that will be added to Layers

var year_vis = [2000,2010,2019]

var year_list = [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019]


var blank = ee.Image(0).mask(0);
var outline = blank.paint(myGrid, 'AA0000', 2); 
var visPar = {'palette':'000000','opacity': 0.6};
Map.addLayer(outline, visPar, grid_name, true);
Map.addLayer(grids, {}, 'grids', false);

// Classes that will be exported
var palettes = require('users/mapbiomas/modules:Palettes.js');
var vis = {
    'min': 0,
    'max': 34,
    'palette': palettes.get('classification2')
};


var ndvi_color = 'ffffff,ce7e45,df923d,f1b555,fcd163,99b718,74a901,66a000,529400,3e8601,207401,056201,004c00,023b01,012e01,011d01,011301'

var visNDFI = {'min':0, 'max':200, 'palette':ndvi_color};
var visNDFI100 = {'min':0, 'max':100, 'palette':ndvi_color};
var vizParams = {'min': 0.00,'max': 0.40, 'bands':'swir1,nir,red','gamma':1.0};
var visPar = {'bands':['swir1','nir','red'], 'gain':[800,600,2000],'gamma':0.5 };
var visParMedian = {'bands':['swir1med_year','nirmed_year','redmed_year'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visParMax = {'bands':['swir1max','nirmax','redmax'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visParMin = {'bands':['swir1min','nirmin','redmin'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visSMA  = {'bands':['medSoil', 'medGV', 'medNPV'], 'gain': [6.0,4.0,6.0]};


var visParMedian2 = {'bands':['median_nir','median_swir1','median_red'], 'gain':[0.06, 0.08,0.2],'gamma':0.5 };
var visParMedian3 = {'bands':['median_nir','median_red','median_green'], 'gain':[0.08,0.2,0.2],'gamma':0.5 };

var visParMedian = {'bands':['median_swir1','median_nir','median_red'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };


var mosaico = ee.ImageCollection(dirasset)
                  .filterMetadata('biome', 'equals', biome)
                  .filterBounds(myGrid.geometry().centroid())

// Add mosaic for each year

for (var year_id in year_list){
  var year = year_list[year_id]
  var mosaicoYear = mosaico.filterMetadata('year', 'equals', year)
  Map.addLayer(mosaicoYear, visParMedian, 'Land_'+ year + '_' + grid_name, false);  
  
}
// Low s definidos da linha 70
for (var year_id in year_vis){
  var year = year_vis[year_id]
  //se der problema tem que alicar reducer min ??
  var mosaicoYear = mosaico.filterMetadata('year', 'equals', year)
  Map.addLayer(mosaicoYear, visParMedian, '*Land_Agro '+ year + '_' + grid_name, false);
  Map.addLayer(mosaicoYear, visParMedian2, '*Land_FalsaCor '+ year + '_' + grid_name, false);
  Map.addLayer(mosaicoYear, visParMedian3, '*Land_FalsaCor2 '+ year + '_' + grid_name, false);
  
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi_dry' ],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI Low '+year, false);
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi_wet'],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI  Hight'+year, false);
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi' ],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI Median'+year, false);
  
  //Map.addLayer(mosaicoYear, {'bands':['median_swir1_dry', 'median_nir_dry', 'median_red_dry' ], 'gain':[0.09, 0.07,0.2],'gamma':0.5 }, '*Median Low NDVI '+year+ grid_name, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_swir1_wet', 'median_nir_wet', 'median_red_wet' ], 'gain':[0.09, 0.07,0.2],'gamma':0.5 }, '*Median Hight  NDVI '+year+ grid_name, false);

  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi_dry' ],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi_wet'],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI Hight '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi' ],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI year'+year, false);

  //Map.addLayer(mosaicoYear, {'bands':['median_fns_dry' ],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_fns_wet'],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS Hight '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_fns' ],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS year'+year, false);

  
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover_dry' ],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover_wet'],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med Hight  '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover' ],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med year'+year, false);

  
  //Map.addLayer(mosaicoYear, {'bands':['median_savi' ],'min':0, 'max':100, 'palette':ndvi_color}, '*SAVI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_pri'],'min':0, 'max':50, 'palette':ndvi_color}, '*PRI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_cai' ],'min':0, 'max':100, 'palette':ndvi_color}, '*CAI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndwi' ],'min':0, 'max':100, 'palette':ndvi_color}, '*NDWI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_gcvi' ],'min':100, 'max':200, 'palette':ndvi_color}, '*GCVI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallheight' ],'min':6150, 'max':6170, 'palette':ndvi_color}, '*HHEIGHT med year'+year, false);
  
  //Map.addLayer(mosaicoYear, {'bands':['median_evi2' ],'min':0, 'max':100, 'palette':ndvi_color}, '*EVI2 med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['stdDev_evi2' ],'min':0, 'max':50, 'palette':ndvi_color}, '*EVI2 std year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['amp_evi2' ],'min':0, 'max':150, 'palette':ndvi_color}, '*EVI2 amp year'+year, false);
  
}
// Samples
// essa lista se refere ao nome das amostras a nível de scripts, esse nome 
// vai ser usado nas diferentes etapas de processamento
  //var samplesList = [c03_florest, c21_agriculture,c33_water]
  var samplesList = [N2_Bosque,
   //N3_Bosque_cerrado,
   //                     N3_Bosque_abierto,
                        N2_Plantaciones_forestales,
                       N2_Area_humeda_natural,
                        N2_Pastizal,
                      //  N2_Pastura,
                    //  N2_Agricultura,
                      N2_Area_no_vegetada,
                        N2_Cuerpos_de_agua,
                        N2_Agricultura_Pastura];
  
//------------------------------------------------------------------
// User defined functions
//------------------------------------------------------------------
/**
 * 
 * @param {*} collection 
 * @param {*} seed 
 */
var shuffle = function (collection, seed) {

    // Adds a column of deterministic pseudorandom numbers to a collection.
    // The range 0 (inclusive) to 1000000000 (exclusive).
    collection = collection.randomColumn('random', seed || 1)
        .sort('random', true)
        .map(
            function (feature) {
                var rescaled = ee.Number(feature.get('random'))
                    .multiply(1000000000)
                    .round();
                return feature.set('new_id', rescaled);
            }
        );

    // list of random ids
    var randomIdList = ee.List(
        collection.reduceColumns(ee.Reducer.toList(), ['new_id'])
        .get('list'));

    // list of sequential ids
    var sequentialIdList = ee.List.sequence(1, collection.size());

    // set new ids
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');

    return shuffled;
};
//faz o merge do todos os poligonos
var totalSample = ee.List(samplesList).iterate(
    function (sample, totalSample) {
        return ee.FeatureCollection(totalSample).merge(sample);
    },
    samplesList[0]
);
//elimina possivel poligono de fora da carta
totalSample = ee.FeatureCollection(totalSample).filterBounds(myGrid);
//cria imagem com pixeis validos onde tem poligonos
var amostraTotalimg = totalSample.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})
amostraTotalimg = amostraTotalimg.select([0],['reference'])

// shuffle polygons and reindex them 
var shuffledpoly = shuffle(totalSample, 2);

// split range in % da
var splitRange = [0.0, 0.7, 1.0];

var sizepoly = shuffledpoly.size();
//cria filtros para separar amostras
var filter1 = ee.Filter.rangeContains('new_id',
    sizepoly.multiply(splitRange[0]).round().add(1),
    sizepoly.multiply(splitRange[1]).round());

var filter2 = ee.Filter.rangeContains('new_id',
    sizepoly.multiply(splitRange[1]).round().add(1),
    sizepoly.multiply(splitRange[2]).round());


var trainingpoly = shuffledpoly.filter(filter1)
    .map(function (feature) {
        return feature.set('type', 'training');
    });
    
var validationpoly = shuffledpoly.filter(filter2)
    .map(function (feature) {
        return feature.set('type', 'validation');
    });

var labeledSamplespoly = validationpoly.merge(trainingpoly);


var validation = amostraTotalimg.stratifiedSample({
    'numPoints': validPoints,
    'classBand': 'reference',
    'region': validationpoly.filterBounds(myGrid),
    'scale': 30,
    'seed': 1,
    'dropNulls': true,
    'geometries':true
});

validation = validation
    .map(function (feature) {
        return feature.set('type', 'validation');
    });
var training = amostraTotalimg.stratifiedSample({
    'numPoints': trainPoints,
    'classBand': 'reference',
    'region': trainingpoly.filterBounds(myGrid),
    'scale': 30,
    'seed': 1,
    'dropNulls': true,
    'geometries':true
});
training = training
    .map(function (feature) {
        return feature.set('type', 'training');
    });

//print('# c03_florest', training)//.filterMetadata('reference', 'equals', 3).size())
//print('# c13_natural_non_forest', training.filterMetadata('reference', 'equals', 13).size())
//print('# c21_agriculture', training.filterMetadata('reference', 'equals', 21).size())
//print('# c25_other_non_vegetated', training.filterMetadata('reference', 'equals', 25).size())
//print('# c33_water', training.filterMetadata('reference', 'equals', 33).size())

Map.addLayer(training,{color:'0000ff'},'training points')
print('training points: ',training.size())
Map.addLayer(validation,{color:'00ff00'},'validation points')
print('validation points: ',validation.size())    

var labeledSamples = validation.merge(training);

//print(labeledSamplespoly)
//print(labeledSamples.size())

Export.table.toAsset({
    "collection": labeledSamplespoly,
    "description": grid_name + '-poly_v'+version_out,
    "assetId": outputAsset + '/' + biome + '/Preclass' + grid_name  +  '-poly_v' + version_out
});

Export.table.toAsset({
    "collection": ee.FeatureCollection(labeledSamples),
    "description": grid_name + '-points_v'+version_out,
    "assetId": outputAsset + '/' + biome + '/Preclass' + grid_name  +  '-points_v'+ version_out
});

Map.centerObject(myGrid.geometry())

var panel = null;
var chk_refresh_plot_flag = null;
var get_panel_chart_ts = function(){
  
  Map.onClick(function(point){
    var punto = ee.Geometry.Point([point["lon"], point["lat"]]);
    
    if(chk_refresh_plot_flag.getValue()){
      panel.remove(panel.widgets().get(1))
      panel.insert(1,ts_tools.get_time_serie_plot(punto));
      
    }
    
  });
  
  chk_refresh_plot_flag = ui.Checkbox("¿Actualizar serie?")
  
  var panel = ui.Panel({
    widgets: [chk_refresh_plot_flag],
    layout: ui.Panel.Layout.Flow('vertical')
  })
  return panel
}
panel = ui.Panel({
  widgets: [utils.get_legend("Clases MB Pampa"),
  get_panel_chart_ts()]
  
})
ui.root.add(panel)
