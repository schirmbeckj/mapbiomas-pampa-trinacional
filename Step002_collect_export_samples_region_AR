/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var N2_Bosque = /* color: #1f4423 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-49.13091607882835, -29.617273786470346]),
            {
              "reference": 2,
              "system:index": "0"
            })]),
    N3_Bosque_cerrado = /* color: #006400 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 3,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.39201484452196, -32.06279680701877]),
            {
              "reference": 3,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.39253701051956, -32.06242472249016],
                  [-62.3930305369783, -32.063270308920714],
                  [-62.392708671896514, -32.06343851604194],
                  [-62.39215077242142, -32.0633976008247],
                  [-62.391694796888885, -32.06360672285383],
                  [-62.391228092520294, -32.062415630120476],
                  [-62.392161501257476, -32.062442907226824],
                  [-62.39235462030655, -32.06246563814258]]]),
            {
              "reference": 3,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.38151046255954, -32.075525394590485],
                  [-62.380641426838714, -32.075416301724225],
                  [-62.38064347582114, -32.07429809233968],
                  [-62.381973851492525, -32.074270818769214],
                  [-62.3821133263613, -32.074716286068195],
                  [-62.381727088263155, -32.07527993545834]]]),
            {
              "reference": 3,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.381403174198944, -32.07475265064985]),
            {
              "reference": 3,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.435778448684744, -32.203801006253514]),
            {
              "reference": 3,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.43590719471746, -32.20410966753746],
                  [-62.43567116032415, -32.204382014859455],
                  [-62.434276411636404, -32.204382014859455],
                  [-62.43437297116094, -32.203764693092445],
                  [-62.435960838897756, -32.20369206672678]]]),
            {
              "reference": 3,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.45249736390956, -32.207962515473916]),
            {
              "reference": 3,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.45294797502406, -32.20800790482829],
                  [-62.45273339830287, -32.208416407998534],
                  [-62.45163905702479, -32.208361941015184],
                  [-62.451585412844494, -32.20759032191353],
                  [-62.452851415499524, -32.20754493235075]]]),
            {
              "reference": 3,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.88287809060689, -32.905291659416164],
                  [-61.882684971557815, -32.9056879931764],
                  [-61.88129022287007, -32.905633947768116],
                  [-61.88129022287007, -32.90496738502012],
                  [-61.88251331018086, -32.90489532388195]]]),
            {
              "reference": 3,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.88206269906636, -32.90520158331416]),
            {
              "reference": 3,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.35713853811214, -32.31745639898308],
                  [-62.35593690847347, -32.31691238163693],
                  [-62.3561944005389, -32.315896873848246],
                  [-62.357009792079424, -32.316041947086546]]]),
            {
              "reference": 3,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.35658063863704, -32.31654970159085]),
            {
              "reference": 3,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.34802254730738, -32.30810960269276]),
            {
              "reference": 3,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.34846242958582, -32.30873528315553],
                  [-62.34727152878321, -32.3087624865559],
                  [-62.34705695206202, -32.308173077719246],
                  [-62.348494616094, -32.30784663425215]]]),
            {
              "reference": 3,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.64540192444213, -32.13260199422231],
                  [-62.64503714401611, -32.132919982200605],
                  [-62.64431831200012, -32.132438457116145],
                  [-62.64443632919677, -32.13183881855188],
                  [-62.6451444323767, -32.13164802363665],
                  [-62.645616501163325, -32.132220407185194]]]),
            {
              "reference": 3,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.644886940311274, -32.13212955289346]),
            {
              "reference": 3,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.557382412926096, -32.055226871179045]),
            {
              "reference": 3,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.557382412926096, -32.05551784942509],
                  [-62.55697471715583, -32.055608779937195],
                  [-62.556395360008615, -32.054990450672754],
                  [-62.55718929387702, -32.054408489900815],
                  [-62.5578330240406, -32.055135940287386]]]),
            {
              "reference": 3,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.66803168203657, -32.20583250186016],
                  [-62.667194832823924, -32.20572356476625],
                  [-62.66736649420088, -32.2049428451088],
                  [-62.668160428069285, -32.205015470475885]]]),
            {
              "reference": 3,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.66758107092207, -32.20536044017768]),
            {
              "reference": 3,
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.105102707026866, -32.36807206144242],
                  [-62.105145622371104, -32.368443596856515],
                  [-62.1048022996172, -32.368824192526574],
                  [-62.10350411045399, -32.36886043964966],
                  [-62.103386093257335, -32.368017690278144],
                  [-62.104609180568126, -32.368008628414245]]]),
            {
              "reference": 3,
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.104094196437266, -32.368343916773355]),
            {
              "reference": 3,
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.33389016694945, -32.93854218570527]),
            {
              "reference": 3,
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.33421203520134, -32.93912745800253],
                  [-62.33409401716359, -32.93953264725546],
                  [-62.333589758048625, -32.939577668443114],
                  [-62.333332263997214, -32.93924451343562],
                  [-62.33319278851138, -32.93854218135969],
                  [-62.33399745695077, -32.93863222417225]]]),
            {
              "reference": 3,
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.608890659452534, -32.40605739591882],
                  [-62.607860691190815, -32.40511535400362],
                  [-62.60966313564882, -32.40471679484908],
                  [-62.61052144253359, -32.4062023245716],
                  [-62.609620220304585, -32.40663710913374]]]),
            {
              "reference": 3,
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.6091910668622, -32.40536898164025]),
            {
              "reference": 3,
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.72838908665462, -32.309813869485524],
                  [-62.72795993321224, -32.309541838271116],
                  [-62.72725183003231, -32.308834553291085],
                  [-62.72815305226131, -32.308036584120835],
                  [-62.729311766555746, -32.30923353524071]]]),
            {
              "reference": 3,
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.72828179829403, -32.30885268887235]),
            {
              "reference": 3,
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.427415048897885, -32.3419161456762]),
            {
              "reference": 3,
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.427693998635434, -32.34207930615303],
                  [-62.42724338752093, -32.342586914643924],
                  [-62.42636362296405, -32.342550656989005],
                  [-62.42634216529193, -32.34169859791612],
                  [-62.427629625619076, -32.34124537173609]]]),
            {
              "reference": 3,
              "system:index": "30"
            })]),
    N3_Bosque_abierto = /* color: #32cd32 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 4,
              "system:index": "0"
            })]),
    N2_Plantaciones_forestales = /* color: #935132 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-57.5333791544041, -31.43818204582587]),
            {
              "reference": 9,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-57.71740015049785, -31.632481625205532],
                  [-57.5278859903416, -31.602075876766545],
                  [-57.68444116612285, -31.54825676684679]]]),
            {
              "reference": 9,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.71034224730835, -32.17554677121784]),
            {
              "reference": 9,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.7105139086853, -32.1758101229384],
                  [-61.710170585931394, -32.1760189875546],
                  [-61.709913093865964, -32.1758555283305],
                  [-61.71005256873474, -32.17538331114618],
                  [-61.710363704980466, -32.17508363358614],
                  [-61.71071775657043, -32.17524709419568]]]),
            {
              "reference": 9,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.133357892358816, -32.380016454457966],
                  [-62.13332570585064, -32.38030639512556],
                  [-62.1328321793919, -32.38027015259299],
                  [-62.13281072171978, -32.37977181629597],
                  [-62.13330424817852, -32.37966308801136]]]),
            {
              "reference": 9,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.133111129129446, -32.379934908477566]),
            {
              "reference": 9,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.7388045467725, -32.94031582513046]),
            {
              "reference": 9,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.73911568291991, -32.940513913403755],
                  [-62.73901912349369, -32.94083805797064],
                  [-62.73820373195316, -32.94080204201171],
                  [-62.738439766346474, -32.94013574412565],
                  [-62.73895475047733, -32.940297817046485]]]),
            {
              "reference": 9,
              "system:index": "7"
            })]),
    N2_Area_humeda_natural = /* color: #45c2a5 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 11,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.67894956995703, -32.50792771733137]),
            {
              "reference": 11,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.679271435038814, -32.50829867681104],
                  [-62.67843458582617, -32.50825343793205],
                  [-62.678509687678584, -32.50753866062298],
                  [-62.6795396559403, -32.50749342136158]]]),
            {
              "reference": 11,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.03098183728113, -32.2926926155889],
                  [-62.03076726055994, -32.29327305576176],
                  [-62.03025227642908, -32.293254917062605],
                  [-62.03033810711756, -32.29247494956598],
                  [-62.03055268383875, -32.29202147700637],
                  [-62.03100329495325, -32.292003338056816]]]),
            {
              "reference": 11,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.030638514527226, -32.29247494956598]),
            {
              "reference": 11,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.89013125244391, -32.32693318868145],
                  [-62.89008833709967, -32.32750887656319],
                  [-62.88926221672308, -32.32747714583039],
                  [-62.88929976764929, -32.32696038661651],
                  [-62.889938133394836, -32.32696038661651]]]),
            {
              "reference": 11,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.88962163273108, -32.327155304912054]),
            {
              "reference": 11,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.90658620006395, -32.33166100596231]),
            {
              "reference": 11,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.90670958167863, -32.33168366972515],
                  [-62.90669080621553, -32.33202362548686],
                  [-62.90650305158449, -32.33211201377579],
                  [-62.90636894113374, -32.33170859985773],
                  [-62.90662911540819, -32.33157714999046]]]),
            {
              "reference": 11,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.875720242302855, -32.36124319600631],
                  [-62.875929454606016, -32.361560384437546],
                  [-62.87603674296661, -32.36200897760487],
                  [-62.87563441161438, -32.36211772712846],
                  [-62.875178436081846, -32.36201350883765],
                  [-62.87514624957367, -32.36146975928502],
                  [-62.875489572327574, -32.361302102513406]]]),
            {
              "reference": 11,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.87555394534393, -32.36158304071148]),
            {
              "reference": 11,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.79037123874456, -32.31776485627425]),
            {
              "reference": 11,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.790280043638056, -32.31843580421588],
                  [-62.79001182273657, -32.318481138356994],
                  [-62.78972214416296, -32.31812299802371],
                  [-62.78934663490087, -32.31779205696314],
                  [-62.7894056434992, -32.31751098278397],
                  [-62.78984016135961, -32.31728430942343],
                  [-62.79043024734289, -32.3176152523393],
                  [-62.79038733199865, -32.31834060244568]]]),
            {
              "reference": 11,
              "system:index": "12"
            })]),
    N2_Pastizal = /* color: #b8af4f */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 12,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.1738596638948, -32.05818314385175],
                  [-62.173763104370266, -32.058937842378086],
                  [-62.17265803425613, -32.05896512052149],
                  [-62.172582932403714, -32.058137679886286]]]),
            {
              "reference": 12,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.17311937420669, -32.05847411269574]),
            {
              "reference": 12,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.152794870936546, -32.095674909335195]),
            {
              "reference": 12,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.15313282927242, -32.09546586065702],
                  [-62.153068456256065, -32.096038471114326],
                  [-62.152054581248436, -32.09604756014026],
                  [-62.151818546855125, -32.09560219680574],
                  [-62.15192047079769, -32.09512956395357]]]),
            {
              "reference": 12,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.73321751493077, -32.44271223792616],
                  [-61.73256305593114, -32.4428480533412],
                  [-61.73193005460362, -32.442264045604524],
                  [-61.73170474904637, -32.441983358369235],
                  [-61.73248795407872, -32.441892813913334],
                  [-61.73309413331609, -32.442368171292124]]]),
            {
              "reference": 12,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.73258451360326, -32.44224593677701]),
            {
              "reference": 12,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.3574520488094, -33.0060947572656]),
            {
              "reference": 12,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.35802067712056, -33.00620272524836],
                  [-62.357816829235425, -33.00648164192547],
                  [-62.357087268383374, -33.00649963651953],
                  [-62.357087268383374, -33.0058518288212],
                  [-62.357838286907544, -33.00581583936512]]]),
            {
              "reference": 12,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.659135563199584, -32.4119834725267]),
            {
              "reference": 12,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.659832937543456, -32.41177515085969],
                  [-62.660079700772826, -32.41213744910191],
                  [-62.65969346267468, -32.41290732803708],
                  [-62.65855084163434, -32.41298431556933],
                  [-62.65790174705273, -32.412708065883855],
                  [-62.65790711147076, -32.41194271397751],
                  [-62.659339411084716, -32.41179326580635]]]),
            {
              "reference": 12,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.96477695252583, -32.33919108392781]),
            {
              "reference": 12,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.96637554909871, -32.33922734292888],
                  [-62.96600003983662, -32.339852808410306],
                  [-62.96538849618123, -32.34049639881322],
                  [-62.963961560985304, -32.34040575255455],
                  [-62.96405812050984, -32.33869252119007],
                  [-62.96605368401692, -32.3383117987044]]]),
            {
              "reference": 12,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.892521880409475, -32.34449158100131]),
            {
              "reference": 12,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.89309050872063, -32.34439187451423],
                  [-62.893036864540335, -32.34476350722578],
                  [-62.89191033675408, -32.34513513841084],
                  [-62.89143826796746, -32.34459128737852],
                  [-62.891803048393484, -32.34395679037571],
                  [-62.89320852591729, -32.344047433077094]]]),
            {
              "reference": 12,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.0159813943454, -32.3598955052135]),
            {
              "reference": 12,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.01671631961548, -32.36006769592352],
                  [-62.01621742873871, -32.360484577337175],
                  [-62.01529474883759, -32.36045738947748],
                  [-62.0148816886493, -32.360180979106545],
                  [-62.01482268005097, -32.359487683802925],
                  [-62.0165392938205, -32.359175019475856],
                  [-62.016700226361394, -32.35973690821684]]]),
            {
              "reference": 12,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.518956134632745, -32.178190629826126]),
            {
              "reference": 12,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.519492576435724, -32.17827235737916],
                  [-61.51900977881304, -32.17839040815958],
                  [-61.517993053958335, -32.17844489308354],
                  [-61.51760430128924, -32.1785357012177],
                  [-61.51764721663348, -32.17760037309864],
                  [-61.51803345473162, -32.177373350261625],
                  [-61.519192169026056, -32.17732794562631],
                  [-61.51962132246844, -32.17820879151091]]]),
            {
              "reference": 12,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.8998893284956, -32.343170337492595]),
            {
              "reference": 12,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.900908567921256, -32.34356916816609],
                  [-62.89949236156139, -32.343623554030835],
                  [-62.899181225315665, -32.34320659489918],
                  [-62.899417259708976, -32.34263553905762],
                  [-62.90104804279003, -32.34261741024172]]]),
            {
              "reference": 12,
              "system:index": "20"
            })]),
    N2_Pastura = /* color: #ffd966 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 15,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.335432664493304, -32.15199870105589],
                  [-62.33545412216542, -32.15259820706684],
                  [-62.33444561157582, -32.15248920626722],
                  [-62.33450998459218, -32.15165352913976],
                  [-62.33560432587026, -32.15150819320509]]]),
            {
              "reference": 15,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.334939138034564, -32.15198053414552]),
            {
              "reference": 15,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.290433571687174, -32.434831573393474]),
            {
              "reference": 15,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.2908519962935, -32.435103227765566],
                  [-62.290648148408366, -32.435546928146465],
                  [-62.289414332261515, -32.43550165269744],
                  [-62.28931777273698, -32.43475913208935],
                  [-62.2907447079329, -32.434641414846006]]]),
            {
              "reference": 15,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.09186454533949, -32.361563052552555],
                  [-62.09115107774153, -32.361739771333504],
                  [-62.090770204061414, -32.360906018158246],
                  [-62.091725070470716, -32.360579764822994],
                  [-62.09213813065901, -32.36109633206019]]]),
            {
              "reference": 15,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.09160168885603, -32.36108726950251]),
            {
              "reference": 15,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.34057218283214, -32.93792989651249],
                  [-62.340679471192736, -32.9382810628915],
                  [-62.339960639176745, -32.938389113804504],
                  [-62.33927399366893, -32.937758814950925],
                  [-62.33909160345592, -32.93739864216054],
                  [-62.339692418275256, -32.937182537782235],
                  [-62.34016448706188, -32.937704789125874]]]),
            {
              "reference": 15,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.33985335081615, -32.93764175895493]),
            {
              "reference": 15,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.52962831991449, -32.161466664148904],
                  [-61.52985362547174, -32.16152115919664],
                  [-61.529923362906125, -32.162166014786756],
                  [-61.529360099013, -32.16218872088631],
                  [-61.52852861421838, -32.1623294985774],
                  [-61.52798144357934, -32.162547476508635],
                  [-61.5278473331286, -32.16204340175126],
                  [-61.52797071474328, -32.16151207669094],
                  [-61.528432054693845, -32.161434875356015],
                  [-61.52945665853753, -32.161434875356015]]]),
            {
              "reference": 15,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.529451294119504, -32.16184358756216]),
            {
              "reference": 15,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.76226225528543, -32.90488845954082],
                  [-61.761811644170926, -32.90521273422589],
                  [-61.761082083318875, -32.9050505970318],
                  [-61.76114645633523, -32.90427593745119],
                  [-61.762605578039334, -32.90431196827963]]]),
            {
              "reference": 15,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.761811644170926, -32.90449212220192]),
            {
              "reference": 15,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.78290784143501, -32.79977883762427],
                  [-61.78297221445137, -32.80016662469851],
                  [-61.78165256761604, -32.800292880590234],
                  [-61.78143799089485, -32.80006742351493],
                  [-61.781341431370315, -32.79949926914939],
                  [-61.78265034936958, -32.79934595703189]]]),
            {
              "reference": 15,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.78212463640266, -32.79970669100524]),
            {
              "reference": 15,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.83003482241462, -32.73603872014374]),
            {
              "reference": 15,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.8305176200373, -32.73645385922665],
                  [-61.830581993053656, -32.73672460106501],
                  [-61.83028158564399, -32.73697729270541],
                  [-61.82969149966071, -32.73676972462477],
                  [-61.82875809092353, -32.73711266293233],
                  [-61.82851132769416, -32.73687802107498],
                  [-61.82842549700568, -32.73647190870813],
                  [-61.8289512099726, -32.7361018936072],
                  [-61.830378145168524, -32.73577700103243]]]),
            {
              "reference": 15,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.90112745952824, -32.554105216547235],
                  [-61.90059101772526, -32.55423182071094],
                  [-61.899786355020794, -32.55406000073119],
                  [-61.899518134119305, -32.55357166846646],
                  [-61.89995801639775, -32.553047160481846],
                  [-61.900483729364666, -32.5528482083755],
                  [-61.90139568042973, -32.55346314982457]]]),
            {
              "reference": 15,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.900258423807415, -32.55339080399043]),
            {
              "reference": 15,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.66176427699608, -32.31294143366466],
                  [-62.66181792117638, -32.31331319550204],
                  [-62.66148532725853, -32.31353081147941],
                  [-62.66071285106224, -32.31377562882904],
                  [-62.66034807063622, -32.31347640753407],
                  [-62.66030515529198, -32.3125696703016],
                  [-62.66180719234032, -32.31236111945433]]]),
            {
              "reference": 15,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.661152733340685, -32.31280542285516]),
            {
              "reference": 15,
              "system:index": "20"
            })]),
    N2_Agricultura = /* color: #e974ed */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 18,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.998545658302305, -32.01504174996962]),
            {
              "reference": 18,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.99904328272589, -32.01493258499141],
                  [-62.99917202875861, -32.015751319158205],
                  [-62.99786311075934, -32.01538743820937],
                  [-62.997519788005434, -32.01451411803689],
                  [-62.99889307902106, -32.01451411803689]]]),
            {
              "reference": 18,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.91571759532739, -32.05721716349032],
                  [-62.9165115291958, -32.0567443321527],
                  [-62.91713380168726, -32.05723534926221],
                  [-62.91556739162256, -32.05767180670281],
                  [-62.914902203786866, -32.057253535030476],
                  [-62.91537427257349, -32.05699893394584]]]),
            {
              "reference": 18,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.916189664114015, -32.05723534926221]),
            {
              "reference": 18,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.721936556228535, -32.03915591461409]),
            {
              "reference": 18,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.72255882871999, -32.039210482686585],
                  [-62.721700521835224, -32.039265050726556],
                  [-62.721400114425556, -32.038610232100424],
                  [-62.722709032424824, -32.0385192846986]]]),
            {
              "reference": 18,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.76869831761359, -32.090429800041804]),
            {
              "reference": 18,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.7689343520069, -32.09070248716645],
                  [-61.768118960466374, -32.091211500955055],
                  [-61.767882926073064, -32.0902661873764],
                  [-61.7689343520069, -32.0897935269195]]]),
            {
              "reference": 18,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.88015989089805, -32.14925918088576],
                  [-61.880503213651956, -32.148205462433694],
                  [-61.882005250700296, -32.147987450198876],
                  [-61.881533181913674, -32.14905933866696]]]),
            {
              "reference": 18,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.88140443588096, -32.14858698259014]),
            {
              "reference": 18,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.52649346078314, -32.5362629856614]),
            {
              "reference": 18,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.52707281793036, -32.53637152509518],
                  [-61.52625742638983, -32.53655242385998],
                  [-61.52604284966864, -32.535828826614576],
                  [-61.52707281793036, -32.53559365625456]]]),
            {
              "reference": 18,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([-61.89059207308677, -32.399513572715485]),
            {
              "reference": 18,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-61.89170787203697, -32.40034696970132],
                  [-61.890763734463725, -32.399839685495685],
                  [-61.88956210482505, -32.400165797097934],
                  [-61.889519189480815, -32.39871640318275],
                  [-61.891750787381206, -32.39897004879755]]]),
            {
              "reference": 18,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.41476574003441, -32.93698324846316]),
            {
              "reference": 18,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.415409470197986, -32.93622687727629],
                  [-62.41579570829613, -32.93788368191806],
                  [-62.413435364363025, -32.9368751958325],
                  [-62.41502323209984, -32.93565059012551]]]),
            {
              "reference": 18,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.02924788854144, -32.88588213711093],
                  [-62.02834666631244, -32.88635063400916],
                  [-62.027917512870054, -32.88444059265754],
                  [-62.02946246526263, -32.88440455374575]]]),
            {
              "reference": 18,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.02881873509906, -32.88498117457561]),
            {
              "reference": 18,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.03588943377272, -32.63229565613298]),
            {
              "reference": 18,
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.035181330592785, -32.63207880929381],
                  [-62.03674774065748, -32.63191617381959],
                  [-62.036940859706554, -32.6326389958869],
                  [-62.034923838527355, -32.63294619349739],
                  [-62.03453760042921, -32.63189810319309]]]),
            {
              "reference": 18,
              "system:index": "20"
            })]),
    N2_Agricultura_Pastura = /* color: #ffefc3 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-49.01006646945335, -29.60772241383939]),
            {
              "reference": 21,
              "system:index": "0"
            })]),
    N2_Area_no_vegetada = /* color: #ea9999 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 22,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.917354227466426, -32.014606831002034],
                  [-62.91731131212219, -32.014904761173945],
                  [-62.916976035995326, -32.01489793835642],
                  [-62.91697871820434, -32.01458408820102]]]),
            {
              "reference": 22,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.917145015163264, -32.01472509347627]),
            {
              "reference": 22,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.91055788468925, -32.01380940105478]),
            {
              "reference": 22,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.91058202457038, -32.01379575525612],
                  [-62.91051496934501, -32.01406412225691],
                  [-62.91025211286155, -32.01407321942962],
                  [-62.91026820611564, -32.013788932356015]]]),
            {
              "reference": 22,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.1058376925658, -32.6951135319097],
                  [-62.10584842140186, -32.69479751895735],
                  [-62.10612737113941, -32.69479751895735],
                  [-62.10611664230335, -32.695104502983725]]]),
            {
              "reference": 22,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.105977167434574, -32.6949510111025]),
            {
              "reference": 22,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.0988549857472, -32.68648680659202],
                  [-62.098543849501475, -32.68647777679357],
                  [-62.098538485083445, -32.68617076310306],
                  [-62.09884962132917, -32.68616173327265]]]),
            {
              "reference": 22,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.09870478204237, -32.686324270080256]),
            {
              "reference": 22,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.103318155730975, -32.70111721264815]),
            {
              "reference": 22,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.10345226618172, -32.701293264679414],
                  [-62.10315185877205, -32.70131132127837],
                  [-62.10313040109993, -32.700999844434364],
                  [-62.10347908827187, -32.70097727360632]]]),
            {
              "reference": 22,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.67823831763077, -32.625297700375235],
                  [-62.67798082556534, -32.625279628412265],
                  [-62.67795936789322, -32.62501758453915],
                  [-62.67822222437668, -32.62500854852986]]]),
            {
              "reference": 22,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.678131029270176, -32.62508987258077]),
            {
              "reference": 22,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.68525719611289, -32.60673265099775],
                  [-62.684956788703225, -32.606691980643916],
                  [-62.684951424285195, -32.606407287649915],
                  [-62.68528938262107, -32.60641632553665]]]),
            {
              "reference": 22,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.68517238991563, -32.6065518937282]),
            {
              "reference": 22,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.68568669716234, -32.60550863177744]),
            {
              "reference": 22,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.685515035785386, -32.60532787203773],
                  [-62.685810078777024, -32.60529623904578],
                  [-62.6858422652852, -32.60563516337818],
                  [-62.68547748485918, -32.605644201342834]]]),
            {
              "reference": 22,
              "system:index": "16"
            })]),
    N2_Cuerpos_de_agua = /* color: #0000ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([-41.21811500733122, -22.6747139537469]),
            {
              "reference": 33,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.79455235106141, -32.94526803372033]),
            {
              "reference": 33,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.79484202963502, -32.94562817445868],
                  [-62.79367258650453, -32.945493121853715],
                  [-62.793736959520885, -32.944916895088],
                  [-62.79406955343873, -32.94487187721376],
                  [-62.79539992911012, -32.94498892363909]]]),
            {
              "reference": 33,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.92531411203692, -32.97797095023049],
                  [-62.9242841437752, -32.97797095023049],
                  [-62.9242841437752, -32.97703492394828],
                  [-62.92557160410235, -32.97692692027726]]]),
            {
              "reference": 33,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.92486350092242, -32.977295932274586]),
            {
              "reference": 33,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.88463625292048, -32.844360914074386]),
            {
              "reference": 33,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.88495811800227, -32.84477554784863],
                  [-62.88362774233088, -32.84475752033351],
                  [-62.8835419116424, -32.84371191819118],
                  [-62.885001033346505, -32.84380205679207]]]),
            {
              "reference": 33,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-62.98505313348277, -32.99359295950448],
                  [-62.98507459115489, -32.9942228601245],
                  [-62.98428065728648, -32.99420486302632],
                  [-62.98419482659801, -32.99368294558263]]]),
            {
              "reference": 33,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([-62.98458106469615, -32.99389891179576]),
            {
              "reference": 33,
              "system:index": "8"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/*********************************************************************
Nombre del Intérprete 1: Diego 
Data Inicio: 20 agosto 2020
Data Termino:
Debe terminar con muestras (# pixeles) entre 10.000 y 15.000
Orientaciones Generales
------------------------------------------------
¡Siempre "SAVE" después de la toma de muestras!
------------------------------------------------
*********************************************************************/
 
//var cartasBR = [
//"SH-21-Y-B","SH-21-Z-A"
//"SH-21-X-A", "SH-21-X-B", "SH-22-V-A", "SH-21-V-D",
//"SH-21-X-C", "SH-21-X-D", "SH-22-V-C", "SH-22-V-D",
//"SH-22-X-C", "SH-21-Y-B", "SH-21-Z-A", "SH-21-Z-B",
//"SH-22-Y-A", "SH-22-Y-B", "SH-22-Z-A", "SH-21-Z-C",
//"SH-21-Z-D", "SH-22-Y-C", "SH-22-Y-D", "SH-22-Z-C",
//"SI-22-V-A","SI-22-V-B", "SI-22-V-C"
//]
//var cartasAR = [
//"SH-21-Y-D"  
//"SH-20-Z-C","SH-20-Z-D","SH-21-Y-A","SH-21-Y-B",
//"SH-21-Y-C","SH-21-Y-D","SI-19-Z-B","SI-19-Z-D","SI-20-V-B","SI-20-V-C","SI-20-V-D","SI-20-X-A",
//"SI-20-X-B","SI-20-X-C","SI-20-X-D","SI-20-Y-A","SI-20-Y-B","SI-20-Y-C","SI-20-Y-D","SI-20-Z-A",
//"SI-20-Z-B","SI-20-Z-C","SI-20-Z-D","SI-21-V-A","SI-21-V-B","SI-21-V-C","SI-21-V-D","SI-21-Y-A",
//"SI-21-Y-B","SI-21-Y-C","SI-21-Y-D","SJ-19-X-B","SJ-19-X-D","SJ-20-V-A","SJ-20-V-B","SJ-20-V-C",
//"SJ-20-V-D","SJ-20-X-A","SJ-20-X-B","SJ-20-X-C","SJ-20-X-D","SJ-20-Y-B","SJ-20-Z-A","SJ-20-Z-B",
//"SJ-20-Z-C","SJ-20-Z-D","SJ-21-V-A","SJ-21-V-B","SJ-21-V-C","SJ-21-V-D","SJ-21-X-A","SJ-21-X-C",
//"SJ-21-Y-A","SJ-21-Y-B"
//]

//var cartasUY = [
//"SH-21-Z-A"  
//"SH-21-Y-B","SH-21-Y-D","SH-21-Z-A","SH-21-Z-C",
//"SH-21-Z-D","SI-21-V-B","SI-21-V-D","SI-21-X-A",
//"SI-21-X-B","SI-21-X-C","SI-21-X-D","SI-21-Y-B",
//"SI-21-Z-A","SI-21-Z-B","SI-22-V-A","SI-22-V-C",
//"SI-22-Y-A"
//]

// Change to your grid_name
var grid_name = "SI-20-X-A"; // todo trocar para regiao
 
//var biome = 'PampaBrasil'
var biome = 'PampaArgentina'
//var biome = 'PampaUruguay'

var version_out = 1     // Version that will be saved
var trainPoints = 2000   // Number of points to training
var validPoints = 500   // Number of points to validate

Map.setOptions("HYBRID");

//************************************
//Do not change bellow this point
var eco=ee.FeatureCollection("users/deabelle/MB_Pampa/segmentacion/zonas_Oy_MB_PAMPA")

var utils = require("users/schirmbeckj/PampaTriNacional:Utils/utils_Pampa.js")
var ts_tools = require("users/schirmbeckj/PampaTriNacional:Utils/time_series.js")

// ajustar para uso dos mapas de reagioes para cada país
var grids = ee.FeatureCollection("projects/MapBiomas_Pampa/ANCILLARY_DATA/CartasPampaTrinacional")
var myGrid = grids.filterMetadata('COD_INT', "equals", grid_name);
print(myGrid)
var dirasset = 'projects/MapBiomas_Pampa/MOSAICS/mosaics_c1';
var outputAsset = 'projects/MapBiomas_Pampa/SAMPLES/C1'

// Landsat images that will be added to Layers

var year_vis = [2000,2010,2019]

var year_list = [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019]


var blank = ee.Image(0).mask(0);
var outline = blank.paint(myGrid, 'AA0000', 2); 
var visPar = {'palette':'000000','opacity': 0.6};
Map.addLayer(outline, visPar, grid_name, true);
Map.addLayer(grids, {}, 'grids', false);

// Classes that will be exported
var palettes = require('users/mapbiomas/modules:Palettes.js');
var vis = {
    'min': 0,
    'max': 34,
    'palette': palettes.get('classification2')
};


var ndvi_color = 'ffffff,ce7e45,df923d,f1b555,fcd163,99b718,74a901,66a000,529400,3e8601,207401,056201,004c00,023b01,012e01,011d01,011301'

var visNDFI = {'min':0, 'max':200, 'palette':ndvi_color};
var visNDFI100 = {'min':0, 'max':100, 'palette':ndvi_color};
var vizParams = {'min': 0.00,'max': 0.40, 'bands':'swir1,nir,red','gamma':1.0};
var visPar = {'bands':['swir1','nir','red'], 'gain':[800,600,2000],'gamma':0.5 };
var visParMedian = {'bands':['swir1med_year','nirmed_year','redmed_year'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visParMax = {'bands':['swir1max','nirmax','redmax'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visParMin = {'bands':['swir1min','nirmin','redmin'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };
var visSMA  = {'bands':['medSoil', 'medGV', 'medNPV'], 'gain': [6.0,4.0,6.0]};


var visParMedian2 = {'bands':['median_nir','median_swir1','median_red'], 'gain':[0.06, 0.08,0.2],'gamma':0.5 };
var visParMedian3 = {'bands':['median_nir','median_red','median_green'], 'gain':[0.08,0.2,0.2],'gamma':0.5 };

var visParMedian = {'bands':['median_swir1','median_nir','median_red'], 'gain':[0.08, 0.06,0.2],'gamma':0.5 };


var mosaico = ee.ImageCollection(dirasset)
                  .filterMetadata('biome', 'equals', biome)
                  .filterBounds(myGrid.geometry().centroid())

// Add mosaic for each year

for (var year_id in year_list){
  var year = year_list[year_id]
  var mosaicoYear = mosaico.filterMetadata('year', 'equals', year)
  Map.addLayer(mosaicoYear, visParMedian, 'Land_'+ year + '_' + grid_name, false);  
  
}
// Low s definidos da linha 70
for (var year_id in year_vis){
  var year = year_vis[year_id]
  //se der problema tem que alicar reducer min ??
  var mosaicoYear = mosaico.filterMetadata('year', 'equals', year)
  Map.addLayer(mosaicoYear, visParMedian, '*Land_Agro '+ year + '_' + grid_name, false);
  Map.addLayer(mosaicoYear, visParMedian2, '*Land_FalsaCor '+ year + '_' + grid_name, false);
  Map.addLayer(mosaicoYear, visParMedian3, '*Land_FalsaCor2 '+ year + '_' + grid_name, false);
  
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi_dry' ],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI Low '+year, false);
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi_wet'],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI  Hight'+year, false);
  Map.addLayer(mosaicoYear, {'bands':['median_ndvi' ],'min':30, 'max':80, 'palette':ndvi_color}, '*NDVI Median'+year, false);
  
  //Map.addLayer(mosaicoYear, {'bands':['median_swir1_dry', 'median_nir_dry', 'median_red_dry' ], 'gain':[0.09, 0.07,0.2],'gamma':0.5 }, '*Median Low NDVI '+year+ grid_name, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_swir1_wet', 'median_nir_wet', 'median_red_wet' ], 'gain':[0.09, 0.07,0.2],'gamma':0.5 }, '*Median Hight  NDVI '+year+ grid_name, false);

  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi_dry' ],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi_wet'],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI Hight '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndfi' ],'min':0, 'max':200, 'palette':ndvi_color}, '*NDFI year'+year, false);

  //Map.addLayer(mosaicoYear, {'bands':['median_fns_dry' ],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_fns_wet'],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS Hight '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_fns' ],'min':0, 'max':200, 'palette':ndvi_color}, '*FNS year'+year, false);

  
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover_dry' ],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med Low '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover_wet'],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med Hight  '+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallcover' ],'min':18270, 'max':18370, 'palette':ndvi_color}, '*HallCover med year'+year, false);

  
  //Map.addLayer(mosaicoYear, {'bands':['median_savi' ],'min':0, 'max':100, 'palette':ndvi_color}, '*SAVI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_pri'],'min':0, 'max':50, 'palette':ndvi_color}, '*PRI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_cai' ],'min':0, 'max':100, 'palette':ndvi_color}, '*CAI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_ndwi' ],'min':0, 'max':100, 'palette':ndvi_color}, '*NDWI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_gcvi' ],'min':100, 'max':200, 'palette':ndvi_color}, '*GCVI med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['median_hallheight' ],'min':6150, 'max':6170, 'palette':ndvi_color}, '*HHEIGHT med year'+year, false);
  
  //Map.addLayer(mosaicoYear, {'bands':['median_evi2' ],'min':0, 'max':100, 'palette':ndvi_color}, '*EVI2 med year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['stdDev_evi2' ],'min':0, 'max':50, 'palette':ndvi_color}, '*EVI2 std year'+year, false);
  //Map.addLayer(mosaicoYear, {'bands':['amp_evi2' ],'min':0, 'max':150, 'palette':ndvi_color}, '*EVI2 amp year'+year, false);
  
}
// Samples
// essa lista se refere ao nome das amostras a nível de scripts, esse nome 
// vai ser usado nas diferentes etapas de processamento
  //var samplesList = [c03_florest, c21_agriculture,c33_water]
  var samplesList = [N2_Bosque,
                      N3_Bosque_cerrado,
                      N3_Bosque_abierto,
                      N2_Plantaciones_forestales,
                      N2_Area_humeda_natural,
                      N2_Pastizal,
                      N2_Pastura,
                      N2_Agricultura,
                      N2_Agricultura_Pastura,
                      N2_Area_no_vegetada,
                      N2_Cuerpos_de_agua];
  
//------------------------------------------------------------------
// User defined functions
//------------------------------------------------------------------
/**
 * 
 * @param {*} collection 
 * @param {*} seed 
 */
var shuffle = function (collection, seed) {

    // Adds a column of deterministic pseudorandom numbers to a collection.
    // The range 0 (inclusive) to 1000000000 (exclusive).
    collection = collection.randomColumn('random', seed || 1)
        .sort('random', true)
        .map(
            function (feature) {
                var rescaled = ee.Number(feature.get('random'))
                    .multiply(1000000000)
                    .round();
                return feature.set('new_id', rescaled);
            }
        );

    // list of random ids
    var randomIdList = ee.List(
        collection.reduceColumns(ee.Reducer.toList(), ['new_id'])
        .get('list'));

    // list of sequential ids
    var sequentialIdList = ee.List.sequence(1, collection.size());

    // set new ids
    var shuffled = collection.remap(randomIdList, sequentialIdList, 'new_id');

    return shuffled;
};
//faz o merge do todos os poligonos
var totalSample = ee.List(samplesList).iterate(
    function (sample, totalSample) {
        return ee.FeatureCollection(totalSample).merge(sample);
    },
    samplesList[0]
);
//elimina possivel poligono de fora da carta
totalSample = ee.FeatureCollection(totalSample).filterBounds(myGrid);
//cria imagem com pixeis validos onde tem poligonos
var amostraTotalimg = totalSample.reduceToImage({properties: ['reference'],reducer: ee.Reducer.first()})
amostraTotalimg = amostraTotalimg.select([0],['reference'])

// shuffle polygons and reindex them 
var shuffledpoly = shuffle(totalSample, 2);

// split range in % da
var splitRange = [0.0, 0.7, 1.0];

var sizepoly = shuffledpoly.size();
//cria filtros para separar amostras
var filter1 = ee.Filter.rangeContains('new_id',
    sizepoly.multiply(splitRange[0]).round().add(1),
    sizepoly.multiply(splitRange[1]).round());

var filter2 = ee.Filter.rangeContains('new_id',
    sizepoly.multiply(splitRange[1]).round().add(1),
    sizepoly.multiply(splitRange[2]).round());


var trainingpoly = shuffledpoly.filter(filter1)
    .map(function (feature) {
        return feature.set('type', 'training');
    });
    
var validationpoly = shuffledpoly.filter(filter2)
    .map(function (feature) {
        return feature.set('type', 'validation');
    });

var labeledSamplespoly = validationpoly.merge(trainingpoly);


var validation = amostraTotalimg.stratifiedSample({
    'numPoints': validPoints,
    'classBand': 'reference',
    'region': validationpoly.filterBounds(myGrid),
    'scale': 30,
    'seed': 1,
    'dropNulls': true,
    'geometries':true
});

validation = validation
    .map(function (feature) {
        return feature.set('type', 'validation');
    });
var training = amostraTotalimg.stratifiedSample({
    'numPoints': trainPoints,
    'classBand': 'reference',
    'region': trainingpoly.filterBounds(myGrid),
    'scale': 30,
    'seed': 1,
    'dropNulls': true,
    'geometries':true
});
training = training
    .map(function (feature) {
        return feature.set('type', 'training');
    });

print('# c03_florest', training)//.filterMetadata('reference', 'equals', 3).size())
//print('# c13_natural_non_forest', training.filterMetadata('reference', 'equals', 13).size())
print('# c21_agriculture', training.filterMetadata('reference', 'equals', 21).size())
//print('# c25_other_non_vegetated', training.filterMetadata('reference', 'equals', 25).size())
print('# c33_water', training.filterMetadata('reference', 'equals', 33).size())

Map.addLayer(training,{color:'0000ff'},'training points')
print('training points: ',training.size())
Map.addLayer(validation,{color:'00ff00'},'validation points')
print('validation points: ',validation.size())    

var labeledSamples = validation.merge(training);

//print(labeledSamplespoly)
//print(labeledSamples.size())

Export.table.toAsset({
    "collection": labeledSamplespoly,
    "description": grid_name + '-poly_v'+version_out,
    "assetId": outputAsset + '/' + biome + '/Preclass' + grid_name  +  '-poly_v' + version_out
});

Export.table.toAsset({
    "collection": ee.FeatureCollection(labeledSamples),
    "description": grid_name + '-points_v'+version_out,
    "assetId": outputAsset + '/' + biome + '/Preclass' + grid_name  +  '-points_v'+ version_out
});

Map.centerObject(myGrid.geometry())

Map.addLayer(eco,{},"Limite ARG",false)

var panel = null;
var chk_refresh_plot_flag = null;
var get_panel_chart_ts = function(){
  
  Map.onClick(function(point){
    var punto = ee.Geometry.Point([point["lon"], point["lat"]]);
    
    if(chk_refresh_plot_flag.getValue()){
      panel.remove(panel.widgets().get(1))
      panel.insert(1,ts_tools.get_time_serie_plot(punto));
      
    }
    
  });
  
  chk_refresh_plot_flag = ui.Checkbox("¿Actualizar serie?")
  
  var panel = ui.Panel({
    widgets: [chk_refresh_plot_flag],
    layout: ui.Panel.Layout.Flow('vertical')
  })
  return panel
}
panel = ui.Panel({
  widgets: [utils.get_legend("Clases MB Pampa"),
  get_panel_chart_ts()]
  
})
ui.root.add(panel)
